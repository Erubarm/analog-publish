## 1. Введение: Почему Бизнес-правила Важны?

На первых лекциях мы определили, что иерархия требований включает Бизнес-требования (БТ), Пользовательские требования (ПТ) и Функциональные требования (ФТ).

**Бизнес-правила (БП)** занимают особое место. По своей сути, это не требование к программному обеспечению (ПО), но они служат **источником** для многих типов требований к ПО.

**Бизнес-правило** — это политика, предписание, стандарт или правило, определяющее или ограничивающее некоторые стороны бизнес-процессов.

### 1.1. Отличие бизнес-правила от функционального требования

Ключевое отличие состоит в том, что правила существуют независимо от системы, в то время как функциональные требования описывают поведение системы для их реализации.

• **Правило (БП):** Внешнее положение политики, которое необходимо соблюдать (например: "Клиентам младше 18 лет нельзя покупать алкоголь").

• **Требование (ФТ):** Поведение системы, реализующее это правило (например: "Система должна проверить дату рождения клиента, прежде чем добавить алкоголь в корзину").

Бизнес-правила **управляют** функциональностью системы. Аналитик должен определить, какие из правил относятся к приложению, какие необходимо реализовать, и как именно.

### 1.2. Проблема "устных знаний" и ценность правил

Если важные правила не задокументированы и не хранятся должным образом, они существуют только "в головах сотрудников". Такое отношение к жизненно важной информации создает проблемы:

1. **Несогласованность:** Разные системы или даже разные части одной системы могут по-разному выполнять одно и то же правило.

2. **Риск:** При увольнении сотрудника теряется критически важная информация.

**Вывод:** Бизнес-правила следует рассматривать как **актив уровня предприятия**, а не проекта. Наличие главного хранилища правил упрощает их согласованную реализацию во всех проектах, на которые эти правила влияют.

## 2. Классификация Бизнес-правил (Таксономия)

Для того чтобы правила было проще выявлять и применять, используется простая таксономия. Наиболее распространенная схема классификации включает пять типов правил, плюс Термины:

### 2.1. Факты (Facts)

Это базовые утверждения или определения, которые являются истинными в предметной области.

• _Пример:_ "Почтовый индекс в США состоит из пяти цифр, за которым следует необязательный дефис и еще четыре цифры".

• **Функция:** Факты служат основой для других правил и часто влияют на требования к данным. БА должен сосредоточиться только на фактах, находящихся **в границах проекта**.

### 2.2. Ограничения (Constraints)

Правила, которые ограничивают поведение системы или бизнеса. Они могут быть разрешительными (что разрешено) или запретительными (что не разрешено).

• _Пример:_ "Только те люди, у которых есть разрешение руководителей лабораторий, могут заказывать химикаты".

• **Функция:** Ограничения часто ведут к созданию функциональности по применению этих ограничений (например, проверка разрешений пользователя).

### 2.3. Активаторы операций (Action Enablers)

Правила, которые при определенных условиях инициируют выполнение определенных действий (операций). Выражаются в форме **"Если <условие верно или наступило событие>, то <что-то произойдет>"**.

• _Пример:_ "Если контейнер с химикатом просрочен, система должна уведомить менеджера текущего владельца контейнера".

• **Функция:** Активаторы операций обусловливают функциональность, предусматривающую выполнение определенных действий при определенных условиях. Сложные активаторы могут быть представлены в виде Таблицы решений (о чем мы поговорим позже).

### 2.4. Вычисления и Выводы (Computations and Inferences)

• **Вычисления (Computations):** Правила, которые описывают, как определять значения на основе других данных.

   ◦ _Пример:_ "Скидка клиента определяется количеством приобретаемых единиц товара".

   ◦ **Предостережение:** При написании правил, особенно для диапазонов, следует следить, чтобы границы не перекрывались, иначе возникнет неоднозначность (например, 5–10 и 10–20).

• **Выводы (Inferences):** Правила, которые создают новый факт или знание на основе имеющихся данных.

   ◦ _Пример:_ "Если сумма заказа превышает 10 000 руб., то клиенту присваивается статус 'Оптовый покупатель'".

### 2.5. Термины (Terms)

Важные для бизнеса слова, фразы и аббревиатуры. Они являются основой для формулирования всех других правил и требований. Их удобно хранить в **Словаре терминов** (который является частью общей спецификации).

## 3. Выявление Бизнес-правил

Выявление правил — это аналитический процесс, который часто выполняется параллельно с выявлением пользовательских требований.

### 3.1. Источники бизнес-правил

Аналитику необходимо активно искать правила, поскольку пользователи могут считать их "общеизвестными" и не упоминать.

1. **Анализ документации:** Изучение нормативных документов, корпоративных политик, отраслевых стандартов, спецификаций из предыдущих проектов и контрактов.

2. **Унаследованные системы (Legacy Systems):** Правила могут быть "зашиты" в требованиях и коде старых систем. БА проводит **обратный инжиниринг** (reverse engineering) для извлечения этих правил.

3. **Моделирование бизнес-процессов:** Моделирование (например, с помощью диаграмм swimlane) заставляет БА искать правила, которые влияют на каждый шаг процесса (ограничения, инициирование событий, правила вычислений).

4. **Интервью и семинары:** БА должен задавать вопросы, которые выявляют ограничения ("Что произойдет, если я сделаю это?", "Кто здесь главный?").

### 3.2. Как отличить идею решения от правила? (Ссылка на Лекцию 4)

Как мы обсуждали на лекции о границах проекта, пользователи часто предлагают **идеи по решению** в виде требований ("Мне нужна большая красная кнопка...").

Бизнес-правила, как и реальные потребности, скрыты за этими идеями. Аналитик должен задавать многократные вопросы "почему?", чтобы докопаться до сути.

• _Пример:_ "Почему только руководитель лаборатории может заказывать химикаты?" (ответ: "Политика компании требует, чтобы только уполномоченные лица несли ответственность за запасы" — это правило).

## 4. Документирование и Управление Бизнес-правилами

Бизнес-правила не должны дублироваться в спецификации требований к ПО (SRS), поскольку они являются корпоративным активом, а не частью одного проекта.

### 4.1. Каталог бизнес-правил (Business Rule Catalog)

БП должны храниться в централизованном каталоге или хранилище (repository) отдельно от SRS.

Каталог должен содержать:

• **Идентификатор:** Уникальный идентификатор правила.

• **Определение правила:** Формулировка правила.

• **Тип правила:** Классификация (Факт, Ограничение и т.д.).

• **Источник:** Где правило было найдено (нормативный документ, куратор проекта, унаследованная система).

### 4.2. Связь правил с функциональными требованиями (Трассировка)

Для обеспечения того, что правила реализованы, и для управления изменениями, должна быть четкая связь между правилом и ФТ.

Вместо дублирования текста правила в SRS, спецификация должна **ссылаться** на правило.

1. **Атрибут "Источник":** В системе управления требованиями можно создать атрибут ФТ под названием "Источник" и указать идентификатор правила.

2. **Матрица связей:** Используется для явного сопоставления ФТ с БП (и наоборот).

3. **Преимущество:** Если правило изменяется (например, меняется регулирующий закон), с помощью трассировки можно быстро найти **все** функциональные требования и части кода в различных проектах, которые нужно изменить.

### 4.3. Применение моделей для сложной логики

Когда активатор операций или вычисление становится слишком сложным для описания текстом, используются визуальные модели:

• **Таблицы решений (Decision Tables):** Идеально подходят для документирования активаторов операций с расширенной логикой. Они позволяют убедиться, что ни одна комбинация условий не была пропущена.

• **Деревья решений (Decision Trees):** Визуальное представление логики, которое также помогает убедиться в полноте охвата всех возможных комбинаций условий.

Такие модели упрощают чтение и сопровождение сложной логики по сравнению с многократно повторяющимися текстовыми требованиями.

## 5. Заключение

Бизнес-правила — это скелет, вокруг которого строится функциональность. Их систематическое выявление, классификация и отдельное документирование в каталоге, связанном с функциональными требованиями через механизм трассировки, является ключевым фактором успеха. Это позволяет управлять изменениями в политиках и стандартах, минимизируя дорогостоящую переделку ПО.