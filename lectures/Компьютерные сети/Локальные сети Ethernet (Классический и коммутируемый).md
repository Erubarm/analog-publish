Введение

1.1. Доминирование Ethernet

Ethernet, стандартизированный как IEEE 802.3, является, безусловно, самой популярной технологией проводных локальных сетей (LAN) в мире. Он успешно вытеснил все остальные технологии канального уровня (например, Token Ring, FDDI) сначала из локальных сетей, а затем и из глобальных, став монополистом.

Секрет успеха Ethernet кроется в его простоте (принцип KISS – Keep It Stupid Simple), низкой стоимости и способности к эволюции с сохранением обратной совместимости.

1.2. Эволюция архитектуры

Технология Ethernet прошла путь от архитектуры на общей широковещательной разделяемой среде, известной как **Классический Ethernet** (Classic Ethernet), до современной архитектуры **Коммутируемого Ethernet** (Switched Ethernet), где используются соединения «точка-точка».

Часть 1: Классический Ethernet (Classic Ethernet) — Разделяемая среда.

2.1. История и физический уровень

Классический Ethernet был разработан Бобом Меткалфом и Дэвидом Боггсом в исследовательском центре Xerox, используя идеи, полученные от системы ALOHA, и был реализован на длинном толстом коаксиальном кабеле. Изначально он работал со скоростью 3 Мбит/с, затем был стандартизирован на 10 Мбит/с.

• **Топология:** Классический Ethernet представлял собой широковещательную передачу всех пакетов по одному линейному кабелю (топология общей шины), который служил разделяемой средой передачи данных.

• **Среда передачи:** Использовались «толстый» коаксиальный кабель (10Base-5) и более гибкий и дешевый «тонкий» коаксиальный кабель (10Base-2).

• **Кодирование:** Сигналы передавались с использованием манчестерского кода.

2.2. Протокол коллективного доступа CSMA/CD

В среде с разделяемым кабелем только одна машина могла успешно передавать сигнал за раз. Для управления доступом к среде использовался распределенный случайный метод доступа, известный как **CSMA/CD** (Carrier-Sense Multiple Access with Collision Detection — множественный доступ с контролем несущей и обнаружением коллизий).

• **Принцип работы CSMA/CD:**

   1. Станция, желающая передать данные, сначала прослушивает канал (контроль несущей).

   2. Если канал свободен, она начинает передачу.

   3. Если канал занят, она ждет его освобождения.
    4. Если две или более станции начинают передачу одновременно, происходит **коллизия**.
    5. При обнаружении коллизии станция прекращает передачу, ждет случайный интервал времени (используя алгоритм двоичной экспоненциальной задержки) и повторяет попытку.

• **Ограничения CSMA/CD (Минимальный размер кадра):**
    ◦ Для корректной работы протокола CSMA/CD необходимо, чтобы передающая станция успела обнаружить коллизию, вызванную переданным ею кадром, еще до окончания его передачи.
    ◦ Это накладывает ограничение на минимальный размер кадра (Tmin​≥RTT), где Tmin​ — время передачи кадра минимальной длины, а RTT — время оборота (время, за которое сигнал проходит между двумя наиболее удаленными точками и возвращается обратно).
    ◦ Именно поэтому был выбран минимальный размер кадра Ethernet в 64 байта. Уменьшение этого размера привело бы к значительному сокращению максимальной длины сети.

2.3. Производительность Классического Ethernet

Классический Ethernet страдал от плохой масштабируемости и низкой предсказуемой производительности.

• **Разделение пропускной способности:** Пропускная способность канала (10 Мбит/с) делилась между всеми узлами сети.

• **Влияние коллизий:** При сильной загрузке сети резко падала полезная пропускная способность. Из-за роста времени ожидания освобождения среды и коллизий, администраторы сетей на разделяемой среде эмпирически не рекомендовали превышать коэффициент использования среды в 30%.

2.4. Формат кадра Ethernet (DIX II)

Кадр Ethernet является единицей данных канального уровня.

|   |   |   |
|---|---|---|
|Поле|Размер (байт)|Назначение|
|**Преамбула** (Preamble)|8|Последовательность битов для синхронизации приемника.|
|**DA** (Destination Address)|6|MAC-адрес узла назначения (48 бит).|
|**SA** (Source Address)|6|MAC-адрес узла отправителя.|
|**Type/Length** (Тип/Длина)|2|Указывает тип протокола верхнего уровня (Ethernet) или длину кадра (802.3).|
|**Data** (Данные)|46–1500|Полезная нагрузка. Дополняется байтами заполнения (pad) до 46 байт для минимальной длины.|
|**FCS** (Frame Check Sequence)|4|32-битная контрольная сумма (CRC-32) для обнаружения ошибок.|

Часть 2: Переход к Коммутируемому Ethernet (Switched Ethernet)

3.1. От концентраторов к коммутаторам

Проблемы классической архитектуры (сложность поиска неисправностей в коаксиальном кабеле, низкая производительность при увеличении числа узлов) привели к физической структуризации сети в топологию «звезда» с использованием витой пары (10Base-T).

• **Концентраторы (Hubs):** Представляли собой многопортовые повторители (устройства физического уровня). Концентратор лишь электрически соединял все провода, имитируя разделяемую среду. Сеть, построенная на концентраторах, логически оставалась одной общей разделяемой средой, и пропускная способность делилась между всеми.

• **Коммутаторы (Switches/Bridges):** Это устройства канального уровня (второго уровня), которые пришли на смену концентраторам и мостам. Мост (bridge) — исторический предшественник и функциональный аналог коммутатора, который соединял два или более разделяемых сегментов в единую сеть.

3.2. Коммутируемая архитектура и микросегментация

Современный Ethernet использует коммутаторы.

• **Архитектура:** Построена на соединениях «точка-точка» между компьютером и портом коммутатора.

• **Микросегментация:** Каждый конечный узел подключается к коммутатору отдельным кабелем. В результате пропускная способность канала больше не делится между всеми узлами, а выделяется каждому сегменту (в данном случае — одному узлу), что повышает общую пропускную способность системы.

3.3. Принцип работы коммутатора (Прозрачный мост)

Коммутаторы (мосты) работают по алгоритму прозрачного моста IEEE 802.1D.

• **Алгоритм обучения (Learning):** Коммутатор пассивно наблюдает за трафиком, запоминая MAC-адреса отправителей и порт, через который кадр поступил. На основе этого строится таблица продвижения.

• **Пересылка (Forwarding):** При поступлении кадра коммутатор проверяет MAC-адрес назначения:

   1. Если адрес назначения находится в той же области коллизий, что и порт, с которого пришел кадр, кадр отбрасывается (фильтрация).

   2. Если адрес назначения известен и находится на другом порту, кадр пересылается только на этот порт.

   3. Если адрес назначения неизвестен (или является широковещательным/групповым), кадр рассылается на все остальные порты (кроме входящего).

• **Безопасность:** Коммутаторы повышают безопасность, пересылая трафик только на порты адресатов (в отличие от концентраторов, которые передают трафик всем).

3.4. Дуплексный режим и CSMA/CD

Коммутируемый Ethernet может работать в двух режимах: полудуплексном (с CSMA/CD) и полнодуплексном (без CSMA/CD).

• **Полный дуплекс (Full Duplex):** Является «нормальным» режимом для коммутируемого Ethernet.

   ◦ **Отсутствие коллизий:** Поскольку соединение «точка-точка» (узел и коммутатор) использует две независимые витые пары, передача данных может идти одновременно в обоих направлениях.

   ◦ **Отмена CSMA/CD:** В полнодуплексном режиме протокол CSMA/CD не применяется.

   ◦ **Производительность:** Снимаются ограничения на максимальный диаметр сети, связанные с требованием распознавания коллизий.

Часть 3: Эволюция скоростей Ethernet (Fast, Gigabit, 10G+)

По мере роста потребностей в пропускной способности Ethernet развивался, сохраняя формат кадра и MAC-адресацию, но радикально меняя физический уровень.

4.1. Fast Ethernet (100 Мбит/с, 802.3u)

Fast Ethernet (принят в 1995 году) увеличил скорость в 10 раз, но оставил все форматы кадров, интерфейсы и процедуры без изменений, кроме физического уровня.

• **Среда:** Использовалась исключительно витая пара и оптоволокно.

• **Кодирование 4B/5B:** Для передачи 4 бит данных используются 5 сигнальных битов. Это избыточный код, который обеспечивает самосинхронизацию, исключая длинные последовательности нулей.

• **Повышенная частота:** Для достижения 100 Мбит/с с использованием 4B/5B передатчик должен работать на повышенной тактовой частоте (125 МГц).

• **Автосогласование (Auto-negotiation):** Позволяет двум станциям автоматически договариваться об оптимальной скорости (10 или 100 Мбит/с) и дуплексном режиме (полный или полудуплекс).

4.2. Gigabit Ethernet (1 Гбит/с, 802.3ab)

Стандартизирован в 1999 году, сохранил обратную совместимость с предыдущими версиями.

• **Режим работы:** Почти всегда используется в полнодуплексном режиме.

• **Кодирование 8B/10B:** Используется для оптоволоконных версий (1000Base-LX/SX). Кодирует 8 бит данных в 10-битное кодовое слово, обеспечивая балансировку и синхронизацию.

• **1000Base-T (на витой паре категории 5):** Чтобы достичь 1 Гбит/с по стандартной витой паре Cat 5 (имеющей полосу 100 МГц):

   ◦ Используются все четыре витые пары кабеля.

   ◦ Передача данных идет одновременно в обоих направлениях по каждой паре.

   ◦ Применяется сложное цифровое кодирование (PAM5 — 5 уровней напряжения) для передачи 2 бит на символ в каждой паре.

• **Jumbo Frames (Джамбо-пакеты):** Нестандартное расширение, допускающее фреймы более 1500 байт (обычно до 9 Кбайт). Используется для уменьшения накладных расходов процессора на обработку большого числа мелких фреймов на высоких скоростях.

4.3. 10G Ethernet и выше

Развитие Ethernet продолжалось с целью увеличения скорости в 10 раз на каждом новом этапе, достигая 40 Гбит/с, 100 Гбит/с и 400 Гбит/с.

• **Только полный дуплекс:** Начиная с 10G Ethernet, полудуплексный режим и, соответственно, протокол CSMA/CD, больше не поддерживаются, что окончательно закрепило уход от разделяемой среды.

• **Параллельные потоки:** Высокие скорости достигаются за счет распараллеливания данных на множество потоков (например, 40G использует 4 потока, 100G — 10 или 20 потоков), передаваемых по отдельным проводникам, оптическим волокнам или волнам (CWDM).

• **Передовое кодирование и FEC (400G Ethernet):** Для достижения 400 Гбит/с применяются очень сложные методы, такие как кодирование PAM4 (4 уровня сигнала). Поскольку увеличение числа состояний сигнала повышает частоту ошибок, для обеспечения надежности используется **Упреждающая коррекция ошибок (FEC)** (Forward Error Correction). FEC добавляет избыточную информацию, позволяя приемнику исправлять ошибки самостоятельно, что критически важно на высоких скоростях.

Часть 4: Роль Ethernet на канальном уровне и будущие тенденции

5.1. Служба Ethernet: ненадежность на канальном уровне

Ethernet предоставляет службу **без подтверждений и без установления соединения**.

• **Обнаружение ошибок:** Ethernet использует CRC-32 (FCS) для обнаружения ошибок. Если принимающий адаптер обнаруживает ошибку, кадр просто отбрасывается.

• **Отсутствие надежности:** Ethernet не предпринимает попыток восстановления потерянных кадров. Забота о надежности (повторная передача, упорядочивание) остается протоколам более высоких уровней, например, TCP. Это приемлемо, поскольку проводные и оптоволоконные каналы имеют очень низкую частоту ошибок.

5.2. Коммутация на канальном уровне и ее расширения

Введение коммутаторов привело к созданию концепций, которые выходят за рамки классического Ethernet.

• **VLAN (Virtual Local Area Networks):** Виртуальные локальные сети позволяют логически структурировать сеть и разделить ее на отдельные широковещательные домены, что повышает безопасность и управляемость. Для реализации VLAN в кадр Ethernet был добавлен специальный заголовок — тег VLAN (стандарт IEEE 802.1Q), что стало серьезным изменением в традиционно неизменном формате кадра Ethernet.

• **Отказоустойчивость:** Для построения коммутируемых сетей без петель используется Протокол покрывающего дерева (STP/RSTP), который логически блокирует избыточные связи. Однако STP переводит избыточные связи в горячий резерв, не повышая производительность.

• **Агрегирование каналов (LAG/Trunks):** Позволяет объединить несколько физических каналов в один логический, что повышает как надежность (при отказе одного канала трафик перенаправляется на оставшиеся), так и производительность.

5.3. Ethernet операторского класса (Carrier Ethernet)

Ethernet перестал быть только технологией LAN.

• **Расширение в WAN/MAN:** Ethernet операторского класса (Carrier Grade Ethernet) — это версия Ethernet, дополненная функциями, необходимыми для работы в сетях операторов связи.

• **Дополнительные функции:** Для работы в глобальных сетях Ethernet был дополнен функциями, касающимися надежности, масштабируемости и управляемости. Введены функции эксплуатации, администрирования и обслуживания (OAM), такие как протокол CFM (Connectivity Fault Management). Эти функции позволяют выполнять мониторинг достижимости узлов и локализовывать неисправности, что было слабым местом Ethernet в классическом виде.

Заключение

Эволюция Ethernet — это яркий пример того, как технология, основанная на простом, но неэффективном методе коллективного доступа (CSMA/CD), смогла адаптироваться к растущим требованиям, полностью изменив свою физическую и логическую архитектуру, перейдя от разделяемой среды к высокоскоростным полнодуплексным коммутируемым соединениям «точка-точка».